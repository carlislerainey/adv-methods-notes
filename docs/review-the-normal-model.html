<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.1 Review: The Normal Model | Statistical Modeling: A Tools Approach</title>
  <meta name="description" content="Lecture notes covering the key tools of regression modeling in political science." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="3.1 Review: The Normal Model | Statistical Modeling: A Tools Approach" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Lecture notes covering the key tools of regression modeling in political science." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.1 Review: The Normal Model | Statistical Modeling: A Tools Approach" />
  
  <meta name="twitter:description" content="Lecture notes covering the key tools of regression modeling in political science." />
  

<meta name="author" content="Carlisle Rainey" />


<meta name="date" content="2022-09-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-3-adding-predictors.html"/>
<link rel="next" href="bernoulli-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Political Methodology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Week 1: Maximum Likelihood<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="class-agenda.html"><a href="class-agenda.html"><i class="fa fa-check"></i><b>1.1</b> Class agenda<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i><b>1.2</b> Maximum Likelihood<span></span></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-bernoulli-distribution"><i class="fa fa-check"></i><b>1.2.1</b> Example: Bernoulli Distribution<span></span></a></li>
<li class="chapter" data-level="1.2.2" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-poisson-distribution"><i class="fa fa-check"></i><b>1.2.2</b> Example: Poisson Distribution<span></span></a></li>
<li class="chapter" data-level="1.2.3" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#remarks"><i class="fa fa-check"></i><b>1.2.3</b> Remarks<span></span></a></li>
<li class="chapter" data-level="1.2.4" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-beta-distribution"><i class="fa fa-check"></i><b>1.2.4</b> Example: Beta Distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="the-invariance-property.html"><a href="the-invariance-property.html"><i class="fa fa-check"></i><b>1.3</b> The Invariance Property<span></span></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="the-invariance-property.html"><a href="the-invariance-property.html#example-bernoulli-odds"><i class="fa fa-check"></i><b>1.3.1</b> Example: Bernoulli Odds<span></span></a></li>
<li class="chapter" data-level="1.3.2" data-path="the-invariance-property.html"><a href="the-invariance-property.html#example-poisson-sd"><i class="fa fa-check"></i><b>1.3.2</b> Example: Poisson SD<span></span></a></li>
<li class="chapter" data-level="1.3.3" data-path="the-invariance-property.html"><a href="the-invariance-property.html#example-beta-mean-and-variance"><i class="fa fa-check"></i><b>1.3.3</b> Example: Beta Mean and Variance<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html"><i class="fa fa-check"></i><b>1.4</b> The Parametric Bootstrap<span></span></a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#example-toothpaste-cap-problm"><i class="fa fa-check"></i><b>1.4.1</b> Example: Toothpaste Cap Problm<span></span></a></li>
<li class="chapter" data-level="1.4.2" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#example-beta-distribution-1"><i class="fa fa-check"></i><b>1.4.2</b> Example: Beta Distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sampling-distribution.html"><a href="sampling-distribution.html"><i class="fa fa-check"></i><b>1.5</b> Sampling Distribution<span></span></a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="sampling-distribution.html"><a href="sampling-distribution.html#example-the-toothpaste-cap-problem"><i class="fa fa-check"></i><b>1.5.1</b> Example: The Toothpaste Cap Problem<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="bias.html"><a href="bias.html"><i class="fa fa-check"></i><b>1.6</b> Bias<span></span></a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="bias.html"><a href="bias.html#example-bernoulli-distribution-1"><i class="fa fa-check"></i><b>1.6.1</b> Example: Bernoulli Distribution<span></span></a></li>
<li class="chapter" data-level="1.6.2" data-path="bias.html"><a href="bias.html#example-poisson-distribution-1"><i class="fa fa-check"></i><b>1.6.2</b> Example: Poisson Distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="consistency.html"><a href="consistency.html"><i class="fa fa-check"></i><b>1.7</b> Consistency<span></span></a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="consistency.html"><a href="consistency.html#example-illustrative"><i class="fa fa-check"></i><b>1.7.1</b> Example: Illustrative<span></span></a></li>
<li class="chapter" data-level="1.7.2" data-path="consistency.html"><a href="consistency.html#example-bernoulli-odds-1"><i class="fa fa-check"></i><b>1.7.2</b> Example: Bernoulli Odds<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="predictive-distribution.html"><a href="predictive-distribution.html"><i class="fa fa-check"></i><b>1.8</b> Predictive Distribution<span></span></a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="predictive-distribution.html"><a href="predictive-distribution.html#example-poisson-distribution-2"><i class="fa fa-check"></i><b>1.8.1</b> Example: Poisson Distribution<span></span></a></li>
<li class="chapter" data-level="1.8.2" data-path="predictive-distribution.html"><a href="predictive-distribution.html#example-beta-distribution-2"><i class="fa fa-check"></i><b>1.8.2</b> Example: Beta Distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.9</b> Exercises<span></span></a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="exercises.html"><a href="exercises.html#questions-about-the-exponential-distribution"><i class="fa fa-check"></i><b>1.9.1</b> Questions About the Exponential Distribution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-2-bayesian-inference.html"><a href="week-2-bayesian-inference.html"><i class="fa fa-check"></i><b>2</b> Week 2: Bayesian Inference<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>2.1</b> Bayesian Inference<span></span></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="bayesian-inference.html"><a href="bayesian-inference.html#mechanics"><i class="fa fa-check"></i><b>2.1.1</b> Mechanics<span></span></a></li>
<li class="chapter" data-level="2.1.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html#posterior-summaries"><i class="fa fa-check"></i><b>2.1.2</b> Posterior Summaries<span></span></a></li>
<li class="chapter" data-level="2.1.3" data-path="bayesian-inference.html"><a href="bayesian-inference.html#posterior-simulation"><i class="fa fa-check"></i><b>2.1.3</b> Posterior Simulation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="example-bernoulli.html"><a href="example-bernoulli.html"><i class="fa fa-check"></i><b>2.2</b> Example: Bernoulli<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="example-bernoulli.html"><a href="example-bernoulli.html#likelihood"><i class="fa fa-check"></i><b>2.2.1</b> The Likelihood<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="example-bernoulli.html"><a href="example-bernoulli.html#the-prior"><i class="fa fa-check"></i><b>2.2.2</b> The Prior<span></span></a></li>
<li class="chapter" data-level="2.2.3" data-path="example-bernoulli.html"><a href="example-bernoulli.html#the-posterior"><i class="fa fa-check"></i><b>2.2.3</b> The Posterior<span></span></a></li>
<li class="chapter" data-level="2.2.4" data-path="example-bernoulli.html"><a href="example-bernoulli.html#point-estimates"><i class="fa fa-check"></i><b>2.2.4</b> Point Estimates<span></span></a></li>
<li class="chapter" data-level="2.2.5" data-path="example-bernoulli.html"><a href="example-bernoulli.html#credible-interval"><i class="fa fa-check"></i><b>2.2.5</b> Credible Interval<span></span></a></li>
<li class="chapter" data-level="2.2.6" data-path="example-bernoulli.html"><a href="example-bernoulli.html#simulation"><i class="fa fa-check"></i><b>2.2.6</b> Simulation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="example-poisson-distribution-3.html"><a href="example-poisson-distribution-3.html"><i class="fa fa-check"></i><b>2.3</b> Example: Poisson Distribution<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="remarks-1.html"><a href="remarks-1.html"><i class="fa fa-check"></i><b>2.4</b> Remarks<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-3-adding-predictors.html"><a href="week-3-adding-predictors.html"><i class="fa fa-check"></i><b>3</b> Week 3: Adding Predictors<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html"><i class="fa fa-check"></i><b>3.1</b> Review: The Normal Model<span></span></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html#distribution"><i class="fa fa-check"></i><b>3.1.1</b> Distribution<span></span></a></li>
<li class="chapter" data-level="3.1.2" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html#linear-predictor"><i class="fa fa-check"></i><b>3.1.2</b> Linear Predictor<span></span></a></li>
<li class="chapter" data-level="3.1.3" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html#fitting-the-normal-linear-model"><i class="fa fa-check"></i><b>3.1.3</b> Fitting the Normal-Linear Model<span></span></a></li>
<li class="chapter" data-level="3.1.4" data-path="review-the-normal-model.html"><a href="review-the-normal-model.html#applied-example"><i class="fa fa-check"></i><b>3.1.4</b> Applied Example<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="bernoulli-model.html"><a href="bernoulli-model.html"><i class="fa fa-check"></i><b>3.2</b> Bernoulli Model<span></span></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="bernoulli-model.html"><a href="bernoulli-model.html#the-linear-probability-model"><i class="fa fa-check"></i><b>3.2.1</b> The Linear Probability Model<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="bernoulli-model.html"><a href="bernoulli-model.html#the-logit-model"><i class="fa fa-check"></i><b>3.2.2</b> The Logit Model<span></span></a></li>
<li class="chapter" data-level="3.2.3" data-path="bernoulli-model.html"><a href="bernoulli-model.html#fitting-a-logit-model"><i class="fa fa-check"></i><b>3.2.3</b> Fitting a Logit Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="poisson-model.html"><a href="poisson-model.html"><i class="fa fa-check"></i><b>3.3</b> Poisson Model<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="poisson-model.html"><a href="poisson-model.html#predictive-distribution-1"><i class="fa fa-check"></i><b>3.3.1</b> Predictive Distribution<span></span></a></li>
<li class="chapter" data-level="3.3.2" data-path="poisson-model.html"><a href="poisson-model.html#posterior-predictive-distribution"><i class="fa fa-check"></i><b>3.3.2</b> Posterior Predictive Distribution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="posterior-predictive-distribution-1.html"><a href="posterior-predictive-distribution-1.html"><i class="fa fa-check"></i><b>3.4</b> [Posterior] Predictive Distribution<span></span></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="posterior-predictive-distribution-1.html"><a href="posterior-predictive-distribution-1.html#for-the-logit-model"><i class="fa fa-check"></i><b>3.4.1</b> … for the logit model<span></span></a></li>
<li class="chapter" data-level="3.4.2" data-path="posterior-predictive-distribution-1.html"><a href="posterior-predictive-distribution-1.html#for-the-poisson-model"><i class="fa fa-check"></i><b>3.4.2</b> … for the Poisson model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="quantities-of-interest.html"><a href="quantities-of-interest.html"><i class="fa fa-check"></i><b>3.5</b> Quantities of Interest<span></span></a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="quantities-of-interest.html"><a href="quantities-of-interest.html#expected-value"><i class="fa fa-check"></i><b>3.5.1</b> Expected Value<span></span></a></li>
<li class="chapter" data-level="3.5.2" data-path="quantities-of-interest.html"><a href="quantities-of-interest.html#first-difference"><i class="fa fa-check"></i><b>3.5.2</b> First Difference<span></span></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modeling: A Tools Approach</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="review-the-normal-model" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Review: The Normal Model<a href="review-the-normal-model.html#review-the-normal-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To fix ideas, we are going to re-develop the linear model from POS 5746.</p>
<p>We imagine a continuous outcome <span class="math inline">\(y = \{y_1, y_1,..., y_n\}\)</span> and a set of predictors or “explanatory variables” <span class="math inline">\(x_1 = \{x_{11}, x_{21}, ..., x_{n1}\}, x_2 = \{x_{12}, x_{22}, ..., x_{n2}\}, ..., x_k = \{x_{1k}, x_{2k}, ..., x_{nk}\}\)</span>.</p>
<p>The notation <span class="math inline">\(y_i\)</span> refers to the <span class="math inline">\(i\)</span>th observation of the outcome variable.</p>
<p>The notation <span class="math inline">\(x_{ij}\)</span> refers to the <span class="math inline">\(i\)</span>th observation of the <span class="math inline">\(j\)</span>th control variable.</p>
<p>The we write the linear regression model as</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \beta_k x_{ik} + r_i.
\]</span></p>
<p>We might then assume that the <span class="math inline">\(r_i\)</span>s follow a normal distribution, so that <span class="math inline">\(r_i \sim N(0, \sigma^2)\)</span> for all <span class="math inline">\(i\)</span>.</p>
<p>The we can define <span class="math inline">\(\mu_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \beta_k x_{ik}\)</span> and see that</p>
<p><span class="math display">\[
y_i \sim N(\mu_i, \sigma^2).
\]</span>
Taking the expectation, we have <span class="math inline">\(E(y_i \mid x_1, x_2, ... , x_n) = \mu_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \beta_k x_{ik}\)</span>. This is just a <em>conditional average</em> (the average of the outcome conditional on the explanatory variables). Sometimes we refer to this quantity as <span class="math inline">\(\hat{y}_i\)</span>.</p>
<p>There are two important features of this model that I want to explore: the <strong>distribution</strong> or “stochastic component” and the <strong>linear predictor</strong> of the model.</p>
<div id="distribution" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Distribution<a href="review-the-normal-model.html#distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This model uses the normal distribution to describe the unexplained variation in <span class="math inline">\(y_i - \hat{y}_i\)</span>. POS 5746 focuses (mostly) on models that assume a normal distribution for the outcome. King (1998) calls this the “stochastic” component of the model.</p>
<p>For now, simply note that we are not restricted to a normal model, we could easily adapt the model to use a Bernoulli, exponential, or Poisson distribution, for example.</p>
</div>
<div id="linear-predictor" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Linear Predictor<a href="review-the-normal-model.html#linear-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The linear predictor <span class="math inline">\(\beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \beta_k x_{ik}\)</span> is <strong>critically</strong> important. So we should spend some time to get familiar with it.</p>
<p>For the sake of this exercise, the values of the <span class="math inline">\(\beta\)</span>s and the <span class="math inline">\(x_{ij}\)</span>s are arbitrary,</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="review-the-normal-model.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github(&#39;IQSS/Zelig&#39;)</span></span>
<span id="cb96-2"><a href="review-the-normal-model.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(macro, <span class="at">package =</span> <span class="st">&quot;Zelig&quot;</span>)</span>
<span id="cb96-3"><a href="review-the-normal-model.html#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="review-the-normal-model.html#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb96-5"><a href="review-the-normal-model.html#cb96-5" aria-hidden="true" tabindex="-1"></a>small_macro <span class="ot">&lt;-</span> macro <span class="sc">%&gt;%</span></span>
<span id="cb96-6"><a href="review-the-normal-model.html#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(unem, gdp, capmob, trade) <span class="sc">%&gt;%</span></span>
<span id="cb96-7"><a href="review-the-normal-model.html#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-8"><a href="review-the-normal-model.html#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.fns =</span> signif, <span class="at">digits =</span> <span class="dv">2</span>)) </span>
<span id="cb96-9"><a href="review-the-normal-model.html#cb96-9" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable</span>(small_macro, <span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">unem</th>
<th align="right">gdp</th>
<th align="right">capmob</th>
<th align="right">trade</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">284</td>
<td align="right">1.5</td>
<td align="right">5.2</td>
<td align="right">-1</td>
<td align="right">88</td>
</tr>
<tr class="even">
<td align="left">336</td>
<td align="right">2.0</td>
<td align="right">4.8</td>
<td align="right">-1</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">101</td>
<td align="right">2.7</td>
<td align="right">3.2</td>
<td align="right">-2</td>
<td align="right">74</td>
</tr>
<tr class="even">
<td align="left">111</td>
<td align="right">6.8</td>
<td align="right">5.3</td>
<td align="right">0</td>
<td align="right">94</td>
</tr>
<tr class="odd">
<td align="left">133</td>
<td align="right">2.6</td>
<td align="right">5.4</td>
<td align="right">-1</td>
<td align="right">33</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="review-the-normal-model.html#cb97-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(unem <span class="sc">~</span> gdp <span class="sc">+</span> capmob <span class="sc">+</span> trade, <span class="at">data =</span> small_macro)</span>
<span id="cb97-2"><a href="review-the-normal-model.html#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">signif</span>(<span class="fu">coef</span>(fit), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## (Intercept)         gdp      capmob       trade 
##     19.0000     -2.4000      4.5000      0.0027</code></pre>
<p><strong>In-Class Exercise</strong> For the <span class="math inline">\(\beta\)</span>s and the <span class="math inline">\(x_{ij}\)</span>s above, compute each <span class="math inline">\(\mu_i\)</span> and <span class="math inline">\(r_i = y_i - \mu_i\)</span>.</p>
<p>Now, let’s bind the explanatory variables into a matrix, so that</p>
<p><span class="math display">\[
X = [x_1, x_2, ..., x_k] = \begin{bmatrix}
    x_{11} &amp; x_{12} &amp;\dots  &amp; x_{1k}\\
    x_{21} &amp; x_{22} &amp;\dots  &amp; x_{2k}\\
    \vdots &amp; \vdots &amp;\ddots &amp; \vdots\\
    x_{n1} &amp; x_{n2} &amp; \dots  &amp; x_{nk}
    \end{bmatrix}.
\]</span>
And let’s bind the <span class="math inline">\(\beta\)</span>s into a column-vector, so that</p>
<p><span class="math display">\[
\beta = \begin{bmatrix}
    \beta_{1} \\
    \beta_{2} \\
    \vdots\\
    \beta_{k}  
    \end{bmatrix}.
\]</span></p>
<p><span class="math inline">\(\beta = [\beta_0, \beta_1, \beta_2, ..., \beta_k]\)</span>.</p>
<p>Notice that we have a <span class="math inline">\(n \times (k + 1)\)</span> matrix <span class="math inline">\(X\)</span> and a <span class="math inline">\((k + 1) x 1\)</span> matrix <span class="math inline">\(\beta\)</span>. I content that the matrix multiplication <span class="math inline">\(\mu = X\beta\)</span> is identical to <span class="math inline">\(\mu_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \beta_k x_{ik}\)</span>.</p>
<p><strong>In-Class Exercise</strong> For the <span class="math inline">\(\beta\)</span>s and the <span class="math inline">\(x_{ij}\)</span>s above, compute each <span class="math inline">\(\mu = X\beta\)</span> and <span class="math inline">\(r = y - \mu\)</span>.</p>
<p>We can confirm with R.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="review-the-normal-model.html#cb99-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> small_macro<span class="sc">$</span>unem</span>
<span id="cb99-2"><a href="review-the-normal-model.html#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="review-the-normal-model.html#cb99-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, </span>
<span id="cb99-4"><a href="review-the-normal-model.html#cb99-4" aria-hidden="true" tabindex="-1"></a>           small_macro<span class="sc">$</span>gdp, </span>
<span id="cb99-5"><a href="review-the-normal-model.html#cb99-5" aria-hidden="true" tabindex="-1"></a>           small_macro<span class="sc">$</span>capmob,</span>
<span id="cb99-6"><a href="review-the-normal-model.html#cb99-6" aria-hidden="true" tabindex="-1"></a>           small_macro<span class="sc">$</span>trade)</span>
<span id="cb99-7"><a href="review-the-normal-model.html#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(X)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1  5.2   -1   88
## [2,]    1  4.8   -1   27
## [3,]    1  3.2   -2   74
## [4,]    1  5.3    0   94
## [5,]    1  5.4   -1   33</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="review-the-normal-model.html#cb101-1" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">signif</span>(<span class="fu">coef</span>(fit), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb101-2"><a href="review-the-normal-model.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(beta)</span></code></pre></div>
<pre><code>##         [,1]
## [1,] 19.0000
## [2,] -2.4000
## [3,]  4.5000
## [4,]  0.0027</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="review-the-normal-model.html#cb103-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> X<span class="sc">%*%</span>beta; mu</span></code></pre></div>
<pre><code>##        [,1]
## [1,] 2.2576
## [2,] 3.0529
## [3,] 2.5198
## [4,] 6.5338
## [5,] 1.6291</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="review-the-normal-model.html#cb105-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> small_macro<span class="sc">$</span>unem <span class="sc">-</span> mu; r</span></code></pre></div>
<pre><code>##         [,1]
## [1,] -0.7576
## [2,] -1.0529
## [3,]  0.1802
## [4,]  0.2662
## [5,]  0.9709</code></pre>
<p>From now on, we can just write…</p>
<ul>
<li><span class="math inline">\(X_i\beta\)</span> rather than <span class="math inline">\(\beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \beta_k x_{ik}\)</span> (returns a <em>scalar</em> <span class="math inline">\(\mu_i\)</span>)</li>
<li><span class="math inline">\(X\beta\)</span> rather than <span class="math inline">\(\beta_0 + \beta_1 x_{1} + \beta_2 x_{2} + \beta_k x_{k}\)</span> (returns a <em>vector</em> <span class="math inline">\(\mu\)</span>)</li>
</ul>
</div>
<div id="fitting-the-normal-linear-model" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Fitting the Normal-Linear Model<a href="review-the-normal-model.html#fitting-the-normal-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="maximum-likelihood-1" class="section level4 hasAnchor" number="3.1.3.1">
<h4><span class="header-section-number">3.1.3.1</span> Maximum Likelihood<a href="review-the-normal-model.html#maximum-likelihood-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It turns out that the usual least-squares solution from POS 5746 is the maximum likelihood estimate of <span class="math inline">\(\beta\)</span>. And the RMS of the residuals is the ML estimator of <span class="math inline">\(\sigma\)</span>.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="review-the-normal-model.html#cb107-1" aria-hidden="true" tabindex="-1"></a>beta_hat <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)<span class="sc">%*%</span><span class="fu">t</span>(X)<span class="sc">%*%</span>y</span>
<span id="cb107-2"><a href="review-the-normal-model.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(beta_hat, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##         [,1]
## [1,] 18.8277
## [2,] -2.3766
## [3,]  4.5184
## [4,]  0.0027</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="review-the-normal-model.html#cb109-1" aria-hidden="true" tabindex="-1"></a>sigma_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((y <span class="sc">-</span> X<span class="sc">%*%</span>beta_hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb109-2"><a href="review-the-normal-model.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sigma_hat, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 1.6</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="review-the-normal-model.html#cb111-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(unem <span class="sc">~</span> gdp <span class="sc">+</span> capmob <span class="sc">+</span> trade, <span class="at">data =</span> small_macro)</span>
<span id="cb111-2"><a href="review-the-normal-model.html#cb111-2" aria-hidden="true" tabindex="-1"></a>arm<span class="sc">::</span><span class="fu">display</span>(fit)</span></code></pre></div>
<pre><code>## lm(formula = unem ~ gdp + capmob + trade, data = small_macro)
##             coef.est coef.se
## (Intercept) 18.83    11.64  
## gdp         -2.38     1.77  
## capmob       4.52     2.33  
## trade        0.00     0.03  
## ---
## n = 5, k = 4
## residual sd = 1.64, R-Squared = 0.85</code></pre>
<p>We can get confidence intervals with the parametric bootstrap.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="review-the-normal-model.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get ml estimates</span></span>
<span id="cb113-2"><a href="review-the-normal-model.html#cb113-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(unem <span class="sc">~</span> gdp <span class="sc">+</span> capmob <span class="sc">+</span> trade, <span class="at">data =</span> small_macro)</span>
<span id="cb113-3"><a href="review-the-normal-model.html#cb113-3" aria-hidden="true" tabindex="-1"></a>mu_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit)  <span class="co"># same as X%*%beta_hat</span></span>
<span id="cb113-4"><a href="review-the-normal-model.html#cb113-4" aria-hidden="true" tabindex="-1"></a>sigma_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(<span class="fu">residuals</span>(fit)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb113-5"><a href="review-the-normal-model.html#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="review-the-normal-model.html#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="co"># do parametric bootstrap</span></span>
<span id="cb113-7"><a href="review-the-normal-model.html#cb113-7" aria-hidden="true" tabindex="-1"></a>n_bs <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb113-8"><a href="review-the-normal-model.html#cb113-8" aria-hidden="true" tabindex="-1"></a>bs_est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(<span class="fu">coef</span>(fit)), <span class="at">nrow =</span> n_bs)</span>
<span id="cb113-9"><a href="review-the-normal-model.html#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_bs) {</span>
<span id="cb113-10"><a href="review-the-normal-model.html#cb113-10" aria-hidden="true" tabindex="-1"></a>  bs_y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(small_macro), <span class="at">mean =</span> mu_hat, <span class="at">sd =</span> sigma_hat)</span>
<span id="cb113-11"><a href="review-the-normal-model.html#cb113-11" aria-hidden="true" tabindex="-1"></a>  bs_fit <span class="ot">&lt;-</span> <span class="fu">update</span>(fit, bs_y <span class="sc">~</span> .)</span>
<span id="cb113-12"><a href="review-the-normal-model.html#cb113-12" aria-hidden="true" tabindex="-1"></a>  bs_est[i, ] <span class="ot">&lt;-</span> <span class="fu">coef</span>(bs_fit)</span>
<span id="cb113-13"><a href="review-the-normal-model.html#cb113-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-14"><a href="review-the-normal-model.html#cb113-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-15"><a href="review-the-normal-model.html#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the quantiles for each coef</span></span>
<span id="cb113-16"><a href="review-the-normal-model.html#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(bs_est, <span class="dv">2</span>, quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span></code></pre></div>
<pre><code>##           [,1]       [,2]     [,3]        [,4]
## 5%   0.6518702 -4.9998081 1.690274 -0.04557350
## 95% 35.5920062  0.4865889 7.987606  0.06363354</code></pre>
</div>
<div id="bayesian" class="section level4 hasAnchor" number="3.1.3.2">
<h4><span class="header-section-number">3.1.3.2</span> Bayesian<a href="review-the-normal-model.html#bayesian" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>stan_glm()</code> function allows us to easily get posterior simulations for the coefficients (and <span class="math inline">\(\sigma\)</span>) for the normal linear model.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="review-the-normal-model.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm); <span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb115-2"><a href="review-the-normal-model.html#cb115-2" aria-hidden="true" tabindex="-1"></a>stan_fit <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(unem <span class="sc">~</span> gdp <span class="sc">+</span> capmob <span class="sc">+</span> trade, <span class="at">data =</span> small_macro, </span>
<span id="cb115-3"><a href="review-the-normal-model.html#cb115-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb115-4"><a href="review-the-normal-model.html#cb115-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chains =</span> <span class="dv">1</span>, </span>
<span id="cb115-5"><a href="review-the-normal-model.html#cb115-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prior =</span> <span class="cn">NULL</span>,</span>
<span id="cb115-6"><a href="review-the-normal-model.html#cb115-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prior_intercept =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="review-the-normal-model.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stan_fit)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      unem ~ gdp + capmob + trade
##  observations: 5
##  predictors:   4
## ------
##             Median MAD_SD
## (Intercept) 19.3   11.7  
## gdp         -2.4    1.7  
## capmob       4.5    2.3  
## trade        0.0    0.0  
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 1.8    0.9   
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
</div>
<div id="applied-example" class="section level3 hasAnchor" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Applied Example<a href="review-the-normal-model.html#applied-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="review-the-normal-model.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb118-2"><a href="review-the-normal-model.html#cb118-2" aria-hidden="true" tabindex="-1"></a>cg <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/parties.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="review-the-normal-model.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 555
## Columns: 10
## $ country              &lt;chr&gt; &quot;Albania&quot;, &quot;Albania&quot;, &quot;Albania&quot;, &quot;Argentina&quot;, &quot;Ar…
## $ year                 &lt;dbl&gt; 1992, 1996, 1997, 1946, 1951, 1954, 1958, 1960, 1…
## $ average_magnitude    &lt;dbl&gt; 1.00, 1.00, 1.00, 10.53, 10.53, 4.56, 8.13, 4.17,…
## $ eneg                 &lt;dbl&gt; 1.106929, 1.106929, 1.106929, 1.342102, 1.342102,…
## $ enep                 &lt;dbl&gt; 2.190, 2.785, 2.870, 5.750, 1.970, 1.930, 2.885, …
## $ upper_tier           &lt;dbl&gt; 28.57, 17.86, 25.80, 0.00, 0.00, 0.00, 0.00, 0.00…
## $ en_pres              &lt;dbl&gt; 0.00, 0.00, 0.00, 2.09, 1.96, 1.96, 2.65, 2.65, 3…
## $ proximity            &lt;dbl&gt; 0.00, 0.00, 0.00, 1.00, 1.00, 0.20, 1.00, 0.20, 1…
## $ social_heterogeneity &lt;chr&gt; &quot;Bottom 3rd of ENEG&quot;, &quot;Bottom 3rd of ENEG&quot;, &quot;Bott…
## $ electoral_system     &lt;chr&gt; &quot;Single-Member District&quot;, &quot;Single-Member District…</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="review-the-normal-model.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting model with ls/ml</span></span>
<span id="cb120-2"><a href="review-the-normal-model.html#cb120-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> enep <span class="sc">~</span> eneg<span class="sc">*</span><span class="fu">log</span>(average_magnitude) <span class="sc">+</span> eneg<span class="sc">*</span>upper_tier <span class="sc">+</span> en_pres<span class="sc">*</span>proximity</span>
<span id="cb120-3"><a href="review-the-normal-model.html#cb120-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(f, <span class="at">data =</span> cg)</span>
<span id="cb120-4"><a href="review-the-normal-model.html#cb120-4" aria-hidden="true" tabindex="-1"></a>arm<span class="sc">::</span><span class="fu">display</span>(fit, <span class="at">detail =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## lm(formula = f, data = cg)
##                             coef.est coef.se t value Pr(&gt;|t|)
## (Intercept)                  2.81     0.20   14.31    0.00   
## eneg                         0.19     0.08    2.47    0.01   
## log(average_magnitude)       0.33     0.11    2.88    0.00   
## upper_tier                   0.05     0.01    4.98    0.00   
## en_pres                      0.35     0.07    4.84    0.00   
## proximity                   -3.42     0.38   -8.98    0.00   
## eneg:log(average_magnitude)  0.08     0.06    1.28    0.20   
## eneg:upper_tier             -0.02     0.00   -3.37    0.00   
## en_pres:proximity            0.80     0.15    5.34    0.00   
## ---
## n = 555, k = 9
## residual sd = 1.59, R-Squared = 0.30</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="review-the-normal-model.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting model with Stan</span></span>
<span id="cb122-2"><a href="review-the-normal-model.html#cb122-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(f, <span class="at">data =</span> cg, <span class="at">chains =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="review-the-normal-model.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit)</span></code></pre></div>
<pre><code>## stan_glm
##  family:       gaussian [identity]
##  formula:      enep ~ eneg * log(average_magnitude) + eneg * upper_tier + en_pres * 
##     proximity
##  observations: 555
##  predictors:   9
## ------
##                             Median MAD_SD
## (Intercept)                  2.8    0.2  
## eneg                         0.2    0.1  
## log(average_magnitude)       0.3    0.1  
## upper_tier                   0.0    0.0  
## en_pres                      0.3    0.1  
## proximity                   -3.4    0.4  
## eneg:log(average_magnitude)  0.1    0.1  
## eneg:upper_tier              0.0    0.0  
## en_pres:proximity            0.8    0.1  
## 
## Auxiliary parameter(s):
##       Median MAD_SD
## sigma 1.6    0.0   
## 
## ------
## * For help interpreting the printed output see ?print.stanreg
## * For info on the priors used see ?prior_summary.stanreg</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-3-adding-predictors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bernoulli-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
